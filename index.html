<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily GA Report - Live Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 1.1em;
        }
        
        .tabs-container {
            background: #f8f9fa;
            padding: 0;
            overflow-x: auto;
            white-space: nowrap;
            border-bottom: 2px solid #dee2e6;
        }
        
        .tabs {
            display: inline-flex;
            gap: 5px;
            padding: 15px 20px 0 20px;
            min-width: 100%;
        }
        
        .tab {
            padding: 12px 24px;
            background: transparent;
            border: none;
            cursor: pointer;
            font-size: 0.95em;
            font-weight: 500;
            color: #666;
            border-radius: 8px 8px 0 0;
            transition: all 0.3s ease;
            white-space: nowrap;
        }
        
        .tab:hover {
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
        }
        
        .tab.active {
            background: white;
            color: #667eea;
            font-weight: 600;
            border-bottom: 3px solid #667eea;
        }
        
        .content {
            padding: 30px;
        }
        
        .sheet-content {
            display: none;
        }
        
        .sheet-content.active {
            display: block;
        }
        
        .search-container {
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .search-box {
            flex: 1;
            min-width: 250px;
            padding: 12px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s;
        }
        
        .search-box:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .info-badge {
            padding: 8px 16px;
            background: #e3f2fd;
            color: #1976d2;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 500;
        }
        
        .table-wrapper {
            overflow-x: auto;
            background: white;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9em;
        }
        
        thead {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        th {
            padding: 14px 12px;
            text-align: left;
            font-weight: 600;
            white-space: nowrap;
            border-right: 1px solid rgba(255,255,255,0.1);
        }
        
        th:last-child {
            border-right: none;
        }
        
        tbody tr {
            border-bottom: 1px solid #f0f0f0;
            transition: background-color 0.2s;
        }
        
        tbody tr:hover {
            background-color: #f8f9ff;
        }
        
        tbody tr:last-child {
            border-bottom: none;
        }
        
        td {
            padding: 12px;
            color: #333;
            border-right: 1px solid #f5f5f5;
        }
        
        td:last-child {
            border-right: none;
        }
        
        .no-data {
            text-align: center;
            padding: 60px 20px;
            color: #999;
            font-size: 1.1em;
        }
        
        .loading {
            text-align: center;
            padding: 60px 20px;
            color: #667eea;
            font-size: 1.2em;
        }
        
        .stats-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .stat-card {
            flex: 1;
            min-width: 200px;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }
        
        .stat-card h3 {
            font-size: 0.9em;
            opacity: 0.9;
            margin-bottom: 8px;
        }
        
        .stat-card .value {
            font-size: 2em;
            font-weight: 700;
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.5em;
            }
            
            .content {
                padding: 15px;
            }
            
            .tab {
                padding: 10px 16px;
                font-size: 0.85em;
            }
            
            table {
                font-size: 0.8em;
            }
            
            th, td {
                padding: 8px;
            }
        }
        
        .export-btn {
            padding: 10px 20px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .export-btn:hover {
            background: #764ba2;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ðŸ“Š Daily GA Report Dashboard</h1>
            <p>Real-time Data Visualization & Analytics</p>
        </div>
        
        <div class="tabs-container">
            <div class="tabs" id="tabsContainer"></div>
        </div>
        
        <div class="content">
            <div class="search-container">
                <input type="text" class="search-box" id="searchBox" placeholder="ðŸ” Search across all data...">
                <span class="info-badge" id="rowCount">Loading...</span>
                <button class="export-btn" onclick="exportCurrentSheet()">ðŸ“¥ Export CSV</button>
            </div>
            
            <div id="contentContainer"></div>
        </div>
    </div>

    <script>
        let sheetsData = {};
        let currentSheet = '';
        let filteredData = {};

        // Load data
        fetch('sheets_data.json')
            .then(response => response.json())
            .then(data => {
                sheetsData = data;
                filteredData = JSON.parse(JSON.stringify(data)); // Deep copy
                initializeDashboard();
            })
            .catch(error => {
                console.error('Error loading data:', error);
                document.getElementById('contentContainer').innerHTML = 
                    '<div class="no-data">Error loading data. Please check the console.</div>';
            });

        function initializeDashboard() {
            // Create tabs
            const tabsContainer = document.getElementById('tabsContainer');
            const contentContainer = document.getElementById('contentContainer');
            
            Object.keys(sheetsData).forEach((sheetName, index) => {
                // Create tab button
                const tab = document.createElement('button');
                tab.className = 'tab' + (index === 0 ? ' active' : '');
                tab.textContent = sheetName;
                tab.onclick = () => switchSheet(sheetName);
                tabsContainer.appendChild(tab);
                
                // Create sheet content
                const sheetDiv = document.createElement('div');
                sheetDiv.className = 'sheet-content' + (index === 0 ? ' active' : '');
                sheetDiv.id = `sheet-${sheetName.replace(/\s/g, '-')}`;
                contentContainer.appendChild(sheetDiv);
            });
            
            // Set first sheet as current and render
            currentSheet = Object.keys(sheetsData)[0];
            renderSheet(currentSheet);
            
            // Setup search
            document.getElementById('searchBox').addEventListener('input', handleSearch);
        }

        function switchSheet(sheetName) {
            // Update tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.toggle('active', tab.textContent === sheetName);
            });
            
            // Update content
            document.querySelectorAll('.sheet-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(`sheet-${sheetName.replace(/\s/g, '-')}`).classList.add('active');
            
            currentSheet = sheetName;
            
            // Clear search and re-render
            document.getElementById('searchBox').value = '';
            filteredData = JSON.parse(JSON.stringify(sheetsData));
            renderSheet(sheetName);
        }

        function renderSheet(sheetName) {
            const sheetDiv = document.getElementById(`sheet-${sheetName.replace(/\s/g, '-')}`);
            const data = filteredData[sheetName];
            
            if (!data || data.length === 0) {
                sheetDiv.innerHTML = '<div class="no-data">No data available</div>';
                updateRowCount(0, 0);
                return;
            }
            
            // Create table
            let html = '<div class="table-wrapper"><table><thead><tr>';
            
            // Header row (first row)
            const headers = data[0];
            headers.forEach(header => {
                html += `<th>${header || ''}</th>`;
            });
            html += '</tr></thead><tbody>';
            
            // Data rows
            for (let i = 1; i < data.length; i++) {
                html += '<tr>';
                data[i].forEach(cell => {
                    html += `<td>${cell || ''}</td>`;
                });
                html += '</tr>';
            }
            
            html += '</tbody></table></div>';
            sheetDiv.innerHTML = html;
            
            updateRowCount(data.length - 1, sheetsData[sheetName].length - 1);
        }

        function handleSearch(e) {
            const searchTerm = e.target.value.toLowerCase().trim();
            
            if (!searchTerm) {
                // Reset to original data
                filteredData = JSON.parse(JSON.stringify(sheetsData));
                renderSheet(currentSheet);
                return;
            }
            
            // Filter current sheet
            const originalData = sheetsData[currentSheet];
            const headers = originalData[0];
            const filtered = [headers]; // Keep headers
            
            for (let i = 1; i < originalData.length; i++) {
                const row = originalData[i];
                const rowText = row.join(' ').toLowerCase();
                if (rowText.includes(searchTerm)) {
                    filtered.push(row);
                }
            }
            
            filteredData[currentSheet] = filtered;
            renderSheet(currentSheet);
        }

        function updateRowCount(filtered, total) {
            const badge = document.getElementById('rowCount');
            if (filtered === total) {
                badge.textContent = `${total} rows`;
            } else {
                badge.textContent = `${filtered} / ${total} rows`;
            }
        }

        function exportCurrentSheet() {
            const data = filteredData[currentSheet];
            if (!data || data.length === 0) return;
            
            // Convert to CSV
            let csv = '';
            data.forEach(row => {
                csv += row.map(cell => {
                    // Escape quotes and wrap in quotes if contains comma
                    const str = String(cell || '');
                    if (str.includes(',') || str.includes('"') || str.includes('\n')) {
                        return '"' + str.replace(/"/g, '""') + '"';
                    }
                    return str;
                }).join(',') + '\n';
            });
            
            // Download
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${currentSheet}.csv`;
            a.click();
            window.URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>
